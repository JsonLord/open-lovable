# Adapted Project: Enhanced Website Cloner with LLM Integration

I'll adapt the `open-lovable` project to incorporate the requested features, including website cloning, LLM integration, and user interaction capabilities.

## Project Structure Overview

### 1. Core Components Integration

**Website Cloning System:**
- Primary: `goclone` (https://github.com/goclone-dev/goclone.git)
  - Command: `git clone https://github.com/goclone-dev/goclone.git`
  - Investigation: A Go-based website cloning tool that preserves structure and assets
  - Impact: Will be the primary cloning engine with fallback capability

- Fallback: `webpage2html` (https://github.com/zTrix/webpage2html.git)
  - Command: `git clone https://github.com/zTrix/webpage2html.git`
  - Investigation: JavaScript-based single-page cloner with HTML beautification
  - Impact: Provides alternative when primary cloner fails

### 2. LLM Integration

**Helmholtz API Endpoints:**
- Base URL: `https://api.helmholtz-blablador.fz-juelich.de/v1`
- Models:
  - `alias-code`: For coding-specific tasks
  - `alias-large`: For planning/architecture tasks
  - `alias-huge`: For full codebase context queries

**Implementation:**
```javascript
async function queryHelmholtz(model, prompt) {
  try {
    const response = await fetch(`https://api.helmholtz-blablador.fz-juelich.de/v1/${model}`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ prompt: prompt })
    });
    return await response.json();
  } catch (error) {
    console.error('Helmholtz API error:', error);
    return null;
  }
}
```

### 3. Error Handling (501)

**Implementation:**
```javascript
async function withRetry(url, options = {}, maxRetries = 5, initialDelay = 30000) {
  let lastError;
  for (let attempt = 1; attempt <= maxRetries; attempt++) {
    try {
      const response = await fetch(url, options);
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      return response;
    } catch (error) {
      lastError = error;
      const delay = attempt < maxRetries ? initialDelay : initialDelay * 2;
      console.log(`Attempt ${attempt} failed. Retrying in ${delay/1000} seconds...`);
      await new Promise(resolve => setTimeout(resolve, delay));
    }
  }
  throw lastError;
}
```

### 4. User Interaction Flow

**Modified Main Process Flow:**
1. User provides URL via endpoint or chat interface
2. System attempts primary cloning (goclone)
3. If fails, attempts fallback (webpage2html)
4. Presents cloned site for user review
5. Allows changes via:
   - Direct text input
   - Uploading a changes file
6. Applies changes using LLM assistance
7. Maintains chat interface for further modifications

**Endpoint Implementation:**
```javascript
// Express route handler
app.post('/clone', async (req, res) => {
  const { url } = req.body;

  try {
    // Attempt cloning with primary method
    const cloneResult = await attemptClone(url);

    // Process and present to user
    res.json({
      status: 'success',
      cloneResult,
      webInterfaceUrl: `/interface/${cloneResult.id}`
    });
  } catch (error) {
    res.status(500).json({ status: 'error', message: error.message });
  }
});
```

### 5. Modern Website Building

**Enhanced Build Process:**
```javascript
async function buildModernSite(clonedData, userChanges) {
  // Use LLM to analyze changes needed
  const analysis = await queryHelmholtz(
    'alias-large',
    `I have cloned a site with structure ${JSON.stringify(clonedData)}
    and user wants these changes: ${userChanges}.
    How should I modernize this?`
  );

  // Apply transformations
  return {
    ...clonedData,
    ...analysis.suggestedChanges,
    modernFeatures: {
      responsiveDesign: true,
      accessibility: true,
      performance: true
    }
  };
}
```

### 6. Chat Interface Integration

**Enhanced Chat System:**
```javascript
// WebSocket handler for real-time modifications
io.on('connection', (socket) => {
  socket.on('siteModification', async (data) => {
    const { siteId, changes } = data;

    try {
      const updatedSite = await applyMod